  # Parking Management System
  
  Backend-приложение для управления парковочной системой: пользователи, транспорт, парковки, места, тарифы, бронирования и парковочные сессии.  
  Проект реализован на **Spring Boot** с использованием **JWT-аутентификации** и **PostgreSQL**.
  
  ---
  
  ## Функциональные возможности
  ## Технологический стек
  
  
  - Управление пользователями и ролями
  - Аутентификация и авторизация на основе JWT
  - Управление транспортными средствами пользователей
  - Управление парковками и парковочными местами
  - Работа с тарифами (цена, шаг биллинга, бесплатные минуты)
  - Бронирование парковочных мест
  - Управление парковочными сессиями (открытие/закрытие)
  - Проверки бизнес-логики и статусов сущностей
  - Документация API через Swagger (OpenAPI)
  
  ---
  
  - Java 21
  - Spring Boot
  - Spring Security + JWT (jjwt)
  - Spring Data JPA / Hibernate
  - PostgreSQL
  - Maven
  - Lombok
  - Swagger / OpenAPI
  
  ---
  
  ## Требования
  
  - JDK 21+
  - Maven 3.8+
  - PostgreSQL 14+
  
  ---
  
  ## Конфигурация приложения
  
  Приложение использует следующие параметры окружения:
  
  | Переменная | Назначение |
  |----------|-----------|
  | `DB_URL` | JDBC URL базы данных |
  | `DB_USER` | Пользователь PostgreSQL |
  | `DB_PASS` | Пароль PostgreSQL |
  | `JWT_SECRET` | Секретный ключ для JWT |
  | `JWT_EXPIRATION_SECONDS` | Время жизни JWT в секундах |
  
  ### Пример `application.properties`
  
  ```properties
  spring.datasource.url=${DB_URL}
  spring.datasource.username=${DB_USER}
  spring.datasource.password=${DB_PASS}
  
  jwt.secret=${JWT_SECRET}
  jwt.expiration-seconds=${JWT_EXPIRATION_SECONDS}
  
  spring.jpa.hibernate.ddl-auto=update
  spring.jpa.show-sql=false
  ```
  # Запуск приложения
  
  ### Через Maven
  
  ```bash
  mvn clean spring-boot:run
  ```
  
  ### Через JAR-файл
  
  ```bash
  mvn clean package
  java -jar target/parking-management-system.jar
  ```
  
  ### При успешном запуске приложение будет доступно по умолчанию на порту 8080.
  
  # Документация API (Swagger)
  
  ### Swagger UI автоматически подключён к проекту.
  ### После запуска приложения документация доступна по адресу:
  
  ```bash
  http://localhost:8080/swagger-ui/index.html
  ```
  
  ### Swagger позволяет:
  - просматривать все доступные эндпоинты,
  - проверять модели запросов и ответов,
  - выполнять запросы напрямую из браузера.
  
  # Аутентификация и авторизация
  В проекте используется JWT (JSON Web Token) для аутентификации и контроля доступа.
  ## Получение JWT
  
  ### JWT-токен выдаётся при успешной аутентификации пользователя.
  Пример:
  ```bash
  POST /auth/login
  ```
  В ответе возвращается JWT, который необходимо использовать для доступа к защищённым эндпоинтам.
  
  # Использование JWT
  ### Токен передаётся в HTTP-заголовке каждого запроса:
  ```bash
  Authorization: Bearer <JWT_TOKEN>
  ```
  
  # Основные сущности системы
  
  User — пользователь системы
  
  Security — учетные данные пользователя (логин, пароль, роль)
  
  Vehicle — транспортное средство пользователя
  
  ParkingLot — парковочная площадка
  
  Spot — парковочное место
  
  Tariff — тариф парковки
  
  Reservation — бронирование парковочного места
  
  ParkingSession — активная или завершённая парковочная сессия
  
  # Архитектура проекта
  Проект построен по классической слоистой архитектуре
  
  ## Описание слоёв
  controller — REST-контроллеры, обработка HTTP-запросов
  
  service — бизнес-логика и транзакции
  
  repository — доступ к базе данных (Spring Data JPA)
  
  model — JPA-сущности
  
  dto — объекты передачи данных
  
  security — JWT, фильтры, конфигурация Spring Security
  
  exception — пользовательские исключения и обработка ошибок
  
  # Бизнес-правила и проверки
  
  ## В проекте реализованы следующие проверки:
  - уникальность номера транспортного средства;
  - контроль статусов пользователей, тарифов и парковочных мест;
  - запрет пересекающихся бронирований одного парковочного места;
  - проверка корректности временных интервалов бронирований;
  - ограничения на создание и завершение парковочных сессий.

  # API Endpoints
  
  ## Аутентификация и авторизация
  *Все эндпоинты аутентификации доступны без авторизации*
  
  ### `POST /auth/login`
  - **Описание**: Аутентификация пользователя и получение JWT токена
  - **Параметры тела запроса**: username, password
  
  ### `POST /auth/register`
  - **Описание**: Регистрация нового пользователя
  - **Параметры тела запроса**: username, password, email, и другие данные пользователя
  
  ## Пользовательские эндпоинты
  
  ### Профиль текущего пользователя (`/me`)
  
  #### `GET /me`
  - **Описание**: Получение информации о текущем аутентифицированном пользователе
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `PUT /me`
  - **Описание**: Обновление профиля текущего пользователя
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  ### Управление пользователями (`/user`)
  
  #### `GET /user`
  - **Описание**: Получение списка всех пользователей
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `GET /user/{id}`
  - **Описание**: Получение пользователя по ID
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `POST /user`
  - **Описание**: Создание нового пользователя
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PUT /user/{id}`
  - **Описание**: Полное обновление пользователя
  - **Требуемые роли**: ADMIN
  
  #### `PATCH /user/{id}/status`
  - **Описание**: Изменение статуса пользователя
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PATCH /user/soft/{id}`
  - **Описание**: Мягкое удаление пользователя
  - **Требуемые роли**: USER, ADMIN
  
  #### `DELETE /user/{id}`
  - **Описание**: Удаление пользователя
  - **Требуемые роли**: ADMIN
  
  ## Управление ролями безопасности (`/security`)
  
  *Все эндпоинты требуют роли ADMIN*
  
  #### `GET /security/{id}`
  - **Описание**: Получение учетных данных безопасности по ID
  
  #### `GET /security/role/{role}`
  - **Описание**: Получение всех пользователей по роли
 
  #### `POST /security/{id}/admin`
  - **Описание**: Назначение роли ADMIN пользователю
  
  #### `POST /security/{id}/operator`
  - **Описание**: Назначение роли OPERATOR пользователю
  
  ## Транспортные средства (`/vehicle`)
  
  #### `GET /vehicle`
  - **Описание**: Получение списка всех транспортных средств
  - **Требуемые роли**: OPERATOR, ADMIN

  #### `GET /vehicle/{id}`
  - **Описание**: Получение транспортного средства по ID
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `POST /vehicle`
  - **Описание**: Создание нового транспортного средства
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `PUT /vehicle/{id}`
  - **Описание**: Обновление транспортного средства
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `DELETE /vehicle/{id}`
  - **Описание**: Удаление транспортного средства
  - **Требуемые роли**: USER, ADMIN
  
  #### `GET /vehicle/user/{userId}`
  - **Описание**: Получение транспортных средств пользователя
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  ## Парковочные площадки (`/parkingLot`)
  
  #### `GET /parkingLot`
  - **Описание**: Получение списка всех парковочных площадок
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `GET /parkingLot/{id}`
  - **Описание**: Получение парковочной площадки по ID
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `POST /parkingLot`
  - **Описание**: Создание новой парковочной площадки
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `POST /parkingLot/with-spots`
  - **Описание**: Создание парковочной площадки с местами
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PUT /parkingLot/{id}`
  - **Описание**: Обновление парковочной площадки
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PATCH /parkingLot/{id}/status`
  - **Описание**: Изменение статуса парковочной площадки
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `DELETE /parkingLot/{id}`
  - **Описание**: Удаление парковочной площадки
  - **Требуемые роли**: ADMIN
  
  #### `GET /parkingLot/{id}/spots/available`
  - **Описание**: Получение доступных мест на парковке
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `GET /parkingLot/{id}/dashboard`
  - **Описание**: Получение дашборда парковочной площадки
  - **Требуемые роли**: OPERATOR, ADMIN
  
  ## Парковочные места (`/spot`)
  
  #### `GET /spot`
  - **Описание**: Получение списка всех парковочных мест
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `GET /spot/{id}`
  - **Описание**: Получение парковочного места по ID
  - **Требуемые роли**: USER, OPERATOR, ADMIN

  #### `POST /spot`
  - **Описание**: Создание нового парковочного места
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PUT /spot/{id}`
  - **Описание**: Обновление парковочного места
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PATCH /spot/{id}/status`
  - **Описание**: Изменение статуса парковочного места
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `DELETE /spot/{id}`
  - **Описание**: Удаление парковочного места
  - **Требуемые роли**: ADMIN
  
  #### `GET /spot/parkingLot/{parkingLotId}`
  - **Описание**: Получение мест определенной парковочной площадки
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  ## Тарифы (`/tariff`)
  
  #### `GET /tariff`
  - **Описание**: Получение списка всех тарифов
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `GET /tariff/{id}`
  - **Описание**: Получение тарифа по ID
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `POST /tariff`
  - **Описание**: Создание нового тарифа
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `PUT /tariff/{id}`
  - **Описание**: Обновление тарифа
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `DELETE /tariff/{id}`
  - **Описание**: Удаление тарифа
  - **Требуемые роли**: ADMIN
  
  ## Бронирования (`/reservation`)
  
  #### `GET /reservation`
  - **Описание**: Получение списка всех бронирований
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `GET /reservation/{id}`
  - **Описание**: Получение бронирования по ID
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `POST /reservation`
  - **Описание**: Создание нового бронирования
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `PUT /reservation/{id}`
  - **Описание**: Обновление бронирования
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `PATCH /reservation/{id}/status`
  - **Описание**: Изменение статуса бронирования
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `DELETE /reservation/{id}`
  - **Описание**: Удаление бронирования
  - **Требуемые роли**: ADMIN
  
  #### `POST /reservation/{id}/cancel`
  - **Описание**: Отмена бронирования
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `GET /reservation/vehicle/{vehicleId}`
  - **Описание**: Получение бронирований транспортного средства
  - **Требуемые роли**: USER, OPERATOR, ADMIN

  #### `GET /reservation/spot/{spotId}`
  - **Описание**: Получение бронирований парковочного места
  - **Требуемые роли**: OPERATOR, ADMIN
  
  ## Парковочные сессии (`/parkingSession`)
  
  #### `GET /parkingSession`
  - **Описание**: Получение списка всех парковочных сессий
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `GET /parkingSession/{id}`
  - **Описание**: Получение парковочной сессии по ID
  - **Требуемые роли**: USER, OPERATOR, ADMIN
  
  #### `POST /parkingSession`
  - **Описание**: Создание новой парковочной сессии
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `POST /parkingSession/from-reservation/{reservationId}`
  - **Описание**: Создание парковочной сессии из бронирования
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `POST /parkingSession/{id}/finish`
  - **Описание**: Завершение парковочной сессии
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `DELETE /parkingSession/{id}`
  - **Описание**: Удаление парковочной сессии
  - **Требуемые роли**: ADMIN
  
  #### `GET /parkingSession/spot/{spotId}`
  - **Описание**: Получение парковочных сессий места
  - **Требуемые роли**: OPERATOR, ADMIN
  
  #### `GET /parkingSession/vehicle/{vehicleId}`
  - **Описание**: Получение парковочных сессий транспортного средства
  - **Требуемые роли**: USER, OPERATOR, ADMIN

  ## Коды ответов
  Код	Описание
  - 200 OK - Запрос выполнен успешно
  - 201 Created	- Ресурс создан успешно
  - 204 No Content - Запрос выполнен, но тело ответа отсутствует
  - 400 Bad Request - Неверные параметры запроса
  - 401 Unauthorized - Требуется аутентификация
  - 403 Forbidden - Доступ запрещен (недостаточно прав)
  - 404 Not Found - Ресурс не найден
  - 409 Conflict - Конфликт данных (например, дублирование)
  - 500 Internal Server Error - Внутренняя ошибка сервера

  # Возможные направления развития
  - реализация refresh-токенов;
  - пагинация и фильтрация данных;
  - контейнеризация приложения с использованием Docker Compose;
